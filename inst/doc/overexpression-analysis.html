<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Christopher B. Cole" />

<meta name="date" content="2016-10-16" />

<title>Overexpression of Terms in a Target Set of Abstracts</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Overexpression of Terms in a Target Set of Abstracts</h1>
<h4 class="author"><em>Christopher B. Cole</em></h4>
<h4 class="date"><em>2016-10-16</em></h4>



<p>In this analysis we seek to find Gene Ontology terms which may be overrepresented in a “target set” of abstracts, such as the results of a PubMed query.</p>
<p>We first fetch all the results of a specific query from Pubmed using the <code>RISmed</code> package and store their abstracts in a <code>data.frame</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RISmed)

<span class="co"># Store the input string for reuse</span>
search_topic &lt;-<span class="st"> &quot;anaphylaxis genetics&quot;</span>
search_query &lt;-<span class="st"> </span><span class="kw">EUtilsSummary</span>(search_topic, <span class="dt">mindate=</span><span class="dv">2014</span>, <span class="dt">maxdate=</span><span class="dv">2015</span>)

<span class="kw">summary</span>(search_query)

pull &lt;-<span class="st"> </span><span class="kw">EUtilsGet</span>(search_query)

data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">'Abstracts'</span> =<span class="st"> </span><span class="kw">AbstractText</span>(pull))

<span class="co"># Get rid of first entry for some reason, seems to always be blank</span>
data[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">as.character</span>(data[,<span class="dv">1</span>])
data &lt;-<span class="st"> </span>data[-<span class="dv">1</span>,]

<span class="kw">head</span>(data)</code></pre></div>
<p>We want to compare the terms found here to something, so we grab all abstracts from 2014 to 2015 which match a similar field, i.e. immunology genetics. Note that only 1000 records are taken by default.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Store the input string for reuse</span>
search_topic &lt;-<span class="st"> &quot;immunology genetics&quot;</span>
search_query &lt;-<span class="st"> </span><span class="kw">EUtilsSummary</span>(search_topic, <span class="co"># Find all articles matching the string</span>
                              <span class="dt">mindate=</span><span class="dv">2014</span>, <span class="co"># From 2014</span>
                              <span class="dt">maxdate=</span><span class="dv">2015</span>, <span class="co"># to 2015</span>
                              <span class="dt">retmax =</span> <span class="dv">1000</span>)  <span class="co"># This is the default but explicit</span>

<span class="kw">summary</span>(search_query)

pull_control &lt;-<span class="st"> </span><span class="kw">EUtilsGet</span>(search_query)

control &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">'Abstracts'</span> =<span class="st"> </span><span class="kw">AbstractText</span>(pull_control))

<span class="co"># Get rid of first entry for some reason, seems to always be blank</span>
control[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">as.character</span>(control[,<span class="dv">1</span>])
control &lt;-<span class="st"> </span>control[-<span class="dv">1</span>,]

<span class="kw">head</span>(control)</code></pre></div>
<p>We now run <code>goldi</code> on each of the entries in both the target group and the control group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(<span class="dt">package =</span> <span class="st">&quot;goldi&quot;</span>, <span class="st">&quot;TDM.go.df&quot;</span>)
  TDM.go.df &lt;-<span class="st"> </span>TDM.go.df[, !<span class="kw">duplicated</span>(<span class="kw">colnames</span>(TDM.go.df))]

  lims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>)

  results &lt;-<span class="st"> </span><span class="kw">list</span>()

  for(i in <span class="dv">1</span>:<span class="kw">length</span>(data)){

    if(!data[i] ==<span class="st"> &quot;&quot;</span>){
      results[[i]] &lt;-<span class="st"> </span><span class="kw">goldi</span>(<span class="dt">doc =</span> data[i],
            <span class="dt">terms =</span> terms,
            <span class="dt">lims =</span> lims,
            <span class="dt">syn =</span> F,
            <span class="dt">object =</span> T,
            <span class="dt">log =</span> <span class="st">&quot;/dev/null&quot;</span>,
            <span class="dt">reader =</span> <span class="st">&quot;local&quot;</span>,
            <span class="dt">output =</span> <span class="st">&quot;/dev/null&quot;</span>,
            <span class="dt">term_tdm =</span> TDM.go.df)
    }
  }

  results &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, results)

  control_results &lt;-<span class="st"> </span><span class="kw">list</span>()

  for(i in <span class="dv">1</span>:<span class="kw">length</span>(control)){
    if(!control[i] ==<span class="st"> &quot;&quot;</span>){
      control_results[[i]] &lt;-<span class="st"> </span><span class="kw">goldi</span>(<span class="dt">doc =</span> control[i],
            <span class="dt">terms =</span> terms,
            <span class="dt">lims =</span> lims,
            <span class="dt">syn =</span> F,
            <span class="dt">object =</span> T,
            <span class="dt">log =</span> <span class="st">&quot;/dev/null&quot;</span>,
            <span class="dt">reader =</span> <span class="st">&quot;local&quot;</span>,
            <span class="dt">output =</span> <span class="st">&quot;/dev/null&quot;</span>,
            <span class="dt">term_tdm =</span> TDM.go.df)
    }
  }
  control_results &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, control_results)</code></pre></div>
<p>This gives us two objects holding the results, <code>results</code> and <code>control_results</code>. We summarize the results and take all the terms in the result set with more than two occurances to minimize spurious hits. We use the method employed by GOrilla to calculate the enrichment of terms in the target set, and limit it to those which have been identified more than five times. We calculate <span class="math inline">\(P\)</span> values using the hypergeometric distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">goldi::<span class="kw">enrichment</span>(<span class="dt">target =</span> results,
                  <span class="dt">control =</span> control_results
                  <span class="dt">threshold =</span> <span class="dv">5</span>)</code></pre></div>
<table style="width:74%;">
<colgroup>
<col width="43%"></col>
<col width="18%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center">Term</th>
<th align="center">Enrichment</th>
<th align="center">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">protein_C_(activated)_activity</td>
<td align="center">66.55</td>
<td align="center">1.257e-20</td>
</tr>
<tr class="even">
<td align="center">CD27_receptor_activity</td>
<td align="center">66</td>
<td align="center">2.614e-21</td>
</tr>
<tr class="odd">
<td align="center">CD40_receptor_activity</td>
<td align="center">66</td>
<td align="center">2.614e-21</td>
</tr>
<tr class="even">
<td align="center">receptor_activator_activity</td>
<td align="center">66</td>
<td align="center">2.614e-21</td>
</tr>
<tr class="odd">
<td align="center">receptor_activity</td>
<td align="center">66</td>
<td align="center">2.614e-21</td>
</tr>
<tr class="even">
<td align="center">IgE_binding</td>
<td align="center">65.34</td>
<td align="center">8.639e-20</td>
</tr>
<tr class="odd">
<td align="center">kinase_activator_activity</td>
<td align="center">65.34</td>
<td align="center">8.639e-20</td>
</tr>
<tr class="even">
<td align="center">kinase_activity</td>
<td align="center">65.34</td>
<td align="center">8.639e-20</td>
</tr>
<tr class="odd">
<td align="center">B_cell_receptor_activity</td>
<td align="center">62.23</td>
<td align="center">5.11e-14</td>
</tr>
<tr class="even">
<td align="center">T_cell_receptor_activity</td>
<td align="center">62.23</td>
<td align="center">5.11e-14</td>
</tr>
</tbody>
</table>
<p>This replicates the analysis presented in our prepublication. The terms above can be easily changed around, and any bunch of strings may be used for comparrison.</p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
